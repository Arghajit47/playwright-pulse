<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reporters & Scripts - Playwright Pulse Report</title>
    <link rel="icon" href="./asset/logo.png" type="image/png" sizes="32x32" />
    <link rel="apple-touch-icon" href="./asset/logo.png">
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <button
      class="menu-toggle"
      id="menu-toggle"
      aria-label="Open navigation menu"
    >
      â˜°
    </button>
    <div class="page-wrapper">
      <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
          <img
            src="./asset/FullLogo.png"
            alt="Playwright Pulse Report Banner"
            class="sidebar-banner"
          />
        </div>
        <ul class="sidebar-nav">
          <li><a href="index.html">Getting Started</a></li>
          <li>
            <a href="reporters-scripts.html" class="active"
              >Reporters & Scripts</a
            >
          </li>
          <li><a href="report-features.html">Report Features</a></li>
          <li><a href="advanced-usage.html">Advanced Usage</a></li>
          <li><a href="comparison.html">Comparison</a></li>
          <li><a href="reference.html">Reference</a></li>
          <li>
            <a
              href="https://postman-test-bit.github.io/pulse-dashboard/"
              class="external-link"
              target="_blank"
              rel="noopener noreferrer"
            >
              Pulse Dashboard
              <img class="new" src="./asset/new.png" alt="new_icon" />
            </a>
          </li>
        </ul>
      </nav>
      <div class="overlay" id="overlay"></div>
      <main class="main-content">
        <h1>Reporters & Scripts</h1>
        <p>
          The package is composed of a core reporter and a set of CLI scripts
          for processing the collected data.
        </p>

        <section id="core-reporter">
          <h2>The Core Reporter</h2>
          <p>
            The main logic resides in <code>playwright-pulse-reporter.ts</code>,
            which implements Playwright's <code>Reporter</code> interface.
          </p>
          <h4>How it Works</h4>
          <ul>
            <li>
              <strong>Event-Driven:</strong> It hooks into Playwright's test
              execution lifecycle using methods like <code>onBegin</code>,
              <code>onTestEnd</code>, and <code>onEnd</code>.
            </li>
            <li>
              <strong>Data Collection:</strong> It captures comprehensive data
              for each test, including status, duration, retries, steps, errors,
              console output, and tags.
            </li>
            <li>
              <strong>Attachment Handling:</strong> When a test completes, the
              reporter automatically processes its attachments. It copies
              screenshots, videos, and trace files into a structured
              <code>pulse-report/attachments/</code> directory.
            </li>
            <li>
              <strong>Sharding Awareness:</strong> The reporter is aware of
              sharding. When run in a sharded environment, it saves its results
              to a temporary file (e.g.,
              <code>.pulse-shard-results-0.json</code>) instead of writing the
              final report.
            </li>
            <li>
              <strong>JSON Output:</strong> At the end of a non-sharded run (or
              after merging shards), it generates the master
              <code>playwright-pulse-report.json</code> file.
            </li>
          </ul>
        </section>

        <section id="cli-scripts">
          <h2>Command-Line Scripts</h2>
          <p>
            These scripts transform the raw JSON data into viewable reports.
            They are designed to be run after
            <code>npx playwright test</code> has completed.
          </p>
          <h4>generate-pulse-report</h4>
          <ul>
            <li>
              <strong>Purpose:</strong> Creates the primary, fully
              self-contained static HTML report with embedded attachments.
            </li>
            <li>
              <strong>Command:</strong> <code>npx generate-pulse-report</code>
            </li>
            <li>
              <strong>Output:</strong>
              <code>pulse-report/playwright-pulse-static-report.html</code>
            </li>
          </ul>
          <h4>generate-report</h4>
          <ul>
            <li>
              <strong>Purpose:</strong> Creates a lightweight HTML report that
              loads attachments dynamically from the
              <code>attachments/</code> folder.
            </li>
            <li><strong>Command:</strong> <code>npx generate-report</code></li>
            <li>
              <strong>Output:</strong>
              <code>pulse-report/playwright-pulse-report.html</code>
            </li>
          </ul>
          <h4>merge-pulse-report</h4>
          <ul>
            <li>
              <strong>Purpose:</strong> Merges test results from multiple shards
              into a single master JSON file.
            </li>
            <li>
              <strong>Command:</strong> <code>npx merge-pulse-report</code>
            </li>
          </ul>
          <h4>send-email</h4>
          <ul>
            <li>
              <strong>Purpose:</strong> To generate and distribute a lightweight
              summary report via email.
            </li>
            <li><strong>Command:</strong> <code>npx send-email</code></li>
          </ul>
        </section>

        <section id="optional-cli-scripts">
          <h2>Optional CLI Scripts</h2>
          <p>
            These scripts are integrated into the main scripts but can be run
            standalone for specific purposes.
          </p>
          <h4>generate-trend</h4>
          <ul>
            <li>
              <strong>Purpose:</strong> Archives the current test run's data to
              enable historical trend analysis.
            </li>
            <li><strong>Command:</strong> <code>npx generate-trend</code></li>
            <li>
              <strong>Details:</strong> The main report generation scripts call
              this automatically. You would run this manually if you only need
              to update historical data without generating a full HTML report.
            </li>
          </ul>
          <h4>generate-email-report</h4>
          <ul>
            <li>
              <strong>Purpose:</strong> Generates the lightweight email summary
              without sending it.
            </li>
            <li>
              <strong>Command:</strong> <code>npx generate-email-report</code>
            </li>
          </ul>
        </section>
      </main>
    </div>
    <script src="script.js"></script>
  </body>
</html>
